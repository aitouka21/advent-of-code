<html>
  <body>
    <canvas id="plot" width="800" , height="800"></canvas>
  </body>
</html>
<script>
  (async () => {
    const res = await fetch("input.txt");
    const input = await res.text();

    const lines = input
      .split("\n")
      .slice(0, -1)
      .map((line) => line.split(" "))
      .map(([dir, step, color]) => ({ dir, step: +step, color }));

    const m = Array.from({ length: 800 }).map(() =>
      Array.from({ length: 800 }).map(() => ".")
    );

    let x = 250;
    let y = 200;

    for (const { dir, step } of lines) {
      switch (dir) {
        case "D":
          for (let i = 0; i < step; ++i) m[x++][y] = "#";
          break;
        case "R":
          for (let i = 0; i < step; ++i) m[x][y++] = "#";
          break;
        case "U":
          for (let i = 0; i < step; ++i) m[x--][y] = "#";
          break;
        case "L":
          for (let i = 0; i < step; ++i) m[x][y--] = "#";
          break;
      }
    }

    const dir = [
      [0, 1],
      [1, 0],
      [0, -1],
      [-1, 0],
    ];

    const queue = [[251, 201]];

    while (queue.length) {
      const [x, y] = queue.shift();
      if (m[x][y] === "#") continue;
      m[x][y] = "#";
      for (const [dx, dy] of dir) {
        if (m[x + dx][y + dy] === ".") {
          queue.push([x + dx, y + dy]);
        }
      }
    }

    const ctx = document.getElementById("plot").getContext("2d");

    const img = ctx.getImageData(0, 0, 800, 800);

    function coordToPoint(x, y) {
      return 800 * x + y;
    }

    function colorPointRed(i) {
      img.data[4 * i] = 255;
      img.data[4 * i + 1] = 0;
      img.data[4 * i + 2] = 0;
      img.data[4 * i + 3] = 255;
    }

    let count = 0;
    const pts = [];
    for (let i = 0; i < 800; i++) {
      for (let j = 0; j < 800; j++) {
        if (m[i][j] === "#") {
          count++;
          pts.push([i, j]);
        }
      }
    }

    pts.forEach(([x, y]) => colorPointRed(coordToPoint(x, y)));

    ctx.putImageData(img, 0, 0);
    console.log(count);
  })();
</script>
